function [s,d] = LgBasis_quad(p,n)
%==========================================================================

x = p(1);
y = p(2);

switch n
    case 4
        s(1,4) = 0; d(2,4) = 0;     

        s(1) = 0.25*(1-x)*(1-y);
        s(2) = 0.25*(1+x)*(1-y);
        s(3) = 0.25*(1+x)*(1+y);
        s(4) = 0.25*(1-x)*(1+y);
        
        d(1,1) = 0.25*y-0.25;
        d(1,2) = 0.25-0.25*y;
        d(1,3) = 0.25+0.25*y;
        d(1,4) =-0.25-0.25*y;
        
        d(2,1) = 0.25*x-0.25;
        d(2,2) =-0.25-0.25*x;
        d(2,3) = 0.25+0.25*x;
        d(2,4) = 0.25-0.25*x;
    case 8
        s(1,8) = 0; d(2,8) = 0;     

        s(1) = 0.25*(x-1)*(1-y)*(1+y+x);
        s(2) = 0.25*(1+x)*(1-y)*(x-y-1);
        s(3) = 0.25*(1+x)*(1+y)*(y+x-1);
        s(4) = 0.25*(1-x)*(1+y)*(y-1-x);
        s(5) = 0.50*(1-x)*(1+x)*(1-y);
        s(6) = 0.50*(1-y)*(1+y)*(1+x);
        s(7) = 0.50*(1-x)*(1+x)*(1+y);
        s(8) = 0.50*(1-y)*(1+y)*(1-x);
        
        d(1,1) = 0.25*(1-y)*(y+2*x);
        d(1,2) = 0.25*(1-y)*(2*x-y);
        d(1,3) = 0.25*(1+y)*(y+2*x);
        d(1,4) = 0.25*(1+y)*(2*x-y);
        d(1,5) = 1.00*x*(y-1);
        d(1,6) = 0.50*(1-y)*(1+y);
        d(1,7) =-1.00*x*(1+y);
        d(1,8) = 0.50*(y-1)*(1+y);
        
        d(2,1) = 0.25*(1-x)*(x+2*y);
        d(2,2) = 0.25*(1+x)*(2*y-x);
        d(2,3) = 0.25*(1+x)*(x+2*y);
        d(2,4) = 0.25*(1-x)*(2*y-x);
        d(2,5) = 0.50*(x-1)*(1+x);
        d(2,6) =-1.00*y*(1+x);
        d(2,7) = 0.50*(1-x)*(1+x);
        d(2,8) = 1.00*y*(x-1);
end

%==========================================================================

end